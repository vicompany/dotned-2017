@model Stock.Website.Models.FundReportModel
@{
    ViewData["Title"] = "Home Page";
}
@if (!string.IsNullOrEmpty(ViewBag.Message))
{
    <div>
        @ViewBag.Message
    </div>
}



<div class="container">
	<main class="main">

       <section class="section">
            <h1>Funds</h1>

            <div class="js-instance">
                <ticker-overview inline-template>
                    <div>
                        <select name="symbol" v-model="selectedSymbol" v-on:change="onTickerSelected">
                            <option
                                v-for="symbol in symbols"
                                v-bind:disabled="tickerExists(symbol)"
                                v-text="symbol">
                            </option>
                        </select>

                        <div class="notification" v-if="tickers.length === 0">No tickers added yet</div>

                        <div class="grid">
                            <div class="cell cell--1/3" v-for="(ticker, index) in tickers" v-bind:class="{ 'is-expanded': ticker.isExpanded }">
                                <ticker
                                    key="index"
                                    v-on:remove="remove"
                                    v-on:toggle-expanded="toggleExpanded"
                                    v-bind:index="index"
                                    v-bind:is-expanded="ticker.isExpanded"
                                    v-bind:symbol="ticker.symbol"
                                    v-bind:passed-quotes="quotes">
                                </ticker>
                            </div>
                        </div>
                    </div>

                </ticker-overview>
            </div>
       </section>

        <section class="section">
            <h2>Fund history</h2>

            Please init the funds by clicking <a asp-action="Init" >Here</a>
            <table class="table">
                <thead>
                    <tr>
                        <td>Fund</td>
                        <td>Amount of bids</td>
                        <td>Average ask</td>
                        <td>Average bid</td>
                    </tr>
                </thead>
                <tbody>
                    @foreach(var fund in Model.Report)
                    {
                        <tr>
                            <td>@fund.Name</td>
                            <td>@fund.AmountOfPrices</td>
                            <td>@fund.AverageBid.ToString("0.00000")</td>
                            <td>@fund.AverageAsk.ToString("0.00000")</td>
                        </tr>
                    }
                </tbody>
            </table>

        </section>
	</main>
</div>

<script type="x-template" id="template-ticker">
	<div class="ticker">
		<div class="ticker__header">
            <h2 class="ticker__title" v-text="symbol"></h2>
            <div class="ticker__actions">
                <button class="button"
                    v-on:click="remove">
                    remove
                </button>
                <button class="button"
                    v-on:click="toggleExpanded"
                    v-text="toggleButtonText">
                </button>
            </div>
        </div>

        <div class="grid">
            <div class="cell">
                <div class="ticker__quote">
                    <div class="ticker__mid"
                        v-bind:class="{ 'is-positive-tick': isPositiveTick, 'is-negative-tick': isNegativeTick }"
                        v-text="quoteMid">
                    </div>

                    <div class="grid">
                        <div class="cell">
                            <div class="ticker__quote-title">Bid</div>
                            <div class="ticker__quote-value" v-text="quote.Bid"></div>
                        </div>

                        <div class="cell">
                            <div class="ticker__quote-title">Ask</div>
                            <div class="ticker__quote-value" v-text="quote.Ask"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cell" v-if="isExpanded">
                <div class="stats">
                    <table class="table table--horizontal table--zebra">
                        <tr class="table__row">
                            <th class="table__head">Name</th>
                            <td class="table__cell" v-text="quote.Name"></td>
                        </tr>
                         <tr class="table__row">
                            <th class="table__head">Currency</th>
                            <td class="table__cell" v-text="quote.Currency"></td>
                        </tr>
                         <tr class="table__row">
                            <th class="table__head">Avg. Daily Volume</th>
                            <td class="table__cell">{{ quote.AverageDailyVolume|formatNumber }}</td>
                        </tr>
                         <tr class="table__row">
                            <th class="table__head">Market Cap.</th>
                            <td class="table__cell">{{ quote.MarketCapitalization }}</td>
                        </tr>
                         <tr class="table__row">
                            <th class="table__head">Earnings Before Interest</th>
                            <td class="table__cell">{{ quote.EBITDA }}</td>
                        </tr>
                    </table>

                    <hr />

                    <table class="table table--horizontal table--zebra">
                         <tr class="table__row">
                            <th class="table__head">Open</th>
                            <td class="table__cell" v-text="quote.Open"></td>
                        </tr>
                        <tr class="table__row">
                            <th class="table__head">Previous close</th>
                            <td class="table__cell" v-text="quote.PreviousClose"></td>
                        </tr>
                        <tr class="table__row">
                            <th class="table__head">Days low</th>
                            <td class="table__cell" v-text="quote.DaysLow"></td>
                        </tr>
                        <tr class="table__row">
                            <th class="table__head">Days High</th>
                            <td class="table__cell" v-text="quote.DaysHigh"></td>
                        </tr>
                        <tr class="table__row">
                            <th class="table__head">Last traded</th>
                            <td class="table__cell" v-text="quote.LastTradeDate"></td>
                        </tr>
                        <tr class="table__row">
                            <th class="table__head">Last trade price</th>
                            <td class="table__cell" v-text="quote.LastTradePriceOnly"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <chart
            v-bind:symbol="symbol"
            v-bind:is-displayed="isExpanded"
            v-bind:class="{ 'is-hidden': !isExpanded }">
        </chart>
	</div>
</script>

<script type="x-template" id="template-chart">
    <div class="chart">
        <div>
            Je suis chart
        </div>
    </div>
</script>
